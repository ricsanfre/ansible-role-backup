#!/bin/bash

#Define a timestamp function
timestamp() {
date "+%b %d %Y %T %Z"
}

RESTIC_WRAPPER={{ restic_etc_dir }}/restic-wrapper.sh
EXCLUDE={{ restic_exclude_file }}
INCLUDE={{ restic_include_file }}
LOG={{ restic_log }}

# Add timestamp
echo "$(timestamp): restic-backup started" | tee -a $LOG
echo "-------------------------------------------------------------------------------" | tee -a $LOG

# Run Backups
$RESTIC_WRAPPER backup \
--exclude-file $EXCLUDE \
--files-from $INCLUDE \
| tee -a $LOG

# Add timestamp
echo "-------------------------------------------------------------------------------" | tee -a $LOG
echo "$(timestamp): restic.sh finished" | tee -a $LOG
printf "\n" | tee -a $LOG
